<!DOCTYPE html>
<html>
<head>
	<style type="text/css">
		html {height:100%}
		body {height:100%; width:100%; margin:0; padding:0;}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDV08HAd_j_u5yqMvVO4qpUmN020-JQqp8"></script>
	<script type="text/javascript" src="map.js"></script>
	<script>
		var map;
		var places;
		function initialize() {
			$.ajax({
				url: './data.json',				
			}).done(function(data) {
				places = JSON.parse(data);
			    var mapOptions = {
			      zoom: 15,
			      center: new google.maps.LatLng(41.8762686,-87.6322661)
			    };
			    map = new google.maps.Map(document.getElementById('map-canvas'),
			        mapOptions);

			  // Try HTML5 geolocation
			 /* if(navigator.geolocation) {
			    navigator.geolocation.getCurrentPosition(function(position) {
			      var pos = new google.maps.LatLng(position.coords.latitude,
			                                       position.coords.longitude);

			      var infowindow = new google.maps.InfoWindow({
			        map: map,
			        position: pos,
			        content: 'Location found using HTML5.'
			      });

			      map.setCenter(pos);
			    }, function() {
			      handleNoGeolocation(true);
			    });
			  } else {
			    // Browser doesn't support Geolocation
			    handleNoGeolocation(false);
			  }*/
				places.forEach(function(place) {
					var marker = new google.maps.Marker({
						position: new google.maps.LatLng(place.lat, place.lon),
						icon: "graylet.png",
						map: map	
					});

					var infowindow = new google.maps.InfoWindow({
						content: place.description
					});

					google.maps.event.addListener(marker,'click',function(){
						infowindow.open(map,marker);
					});
				});

				map.addListener('click', function(e) {
					alert(e.latLng);
				});
			});
		}

		
		
		/*function handleNoGeolocation(errorFlag) {
		  if (errorFlag) {
		    var content = 'Error: The Geolocation service failed.';
		  } else {
		    var content = 'Error: Your browser doesn\'t support geolocation.';
		  }
		 

		  var options = {
		    map: map,
		    position: new google.maps.LatLng(41.8, -87.6),
		    content: content
		  };

		  var infowindow = new google.maps.InfoWindow(options);
		  map.setCenter(options.position);
		}*/

		google.maps.event.addDomListener(window, 'load', initialize);
	</script>
	<title>Crapstr</title>
	<link rel="icon" href="graylet.png">
</head>
<body>
<style>
	body{font-family:verdana;
		}
	/*#logotext{margin-left: 10px;}*/
	h1{margin-top: 10px;}
</style>
	
	<div id="header">
		<h1>Welcome to </h1><img src="logotextsmall.png"/>
		<!-- <div id="logotext">
			<img src="logotextsmall.png"/>
		</div> -->
		<p>Crapstr is the number one site to find and rate local toilets. Never make one of those ridiculous toilet paper seat covers again!</p>
	</div>
	<h2>Toilets near you:</h2>
	<div id ="map-canvas" style="width:100%; height:100%"></div>
		


</body>
<!-- <footer>
	<div id="logo">
		<img src="CrapstrLogoFinalSmall.png"/>
	</div>
</footer> -->
</html>
